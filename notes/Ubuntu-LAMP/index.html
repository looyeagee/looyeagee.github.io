<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="author" content="LooyeaGee"><title>Ubuntu Server笔记(二):安装LAMP环境 | 亦之日记</title><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/style.css?20200712"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><script src="https://cdn.jsdelivr.net/npm/jquery@3.1.1/dist/jquery.min.js"></script><script src="/js/script.js"></script><script src="/js/tocbot.min.js"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js",(e=document.getElementsByTagName("script")[0]).parentNode.insertBefore(t,e)}()</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script>$(function(){$("img").each(function(){var t;console.log($(this).data("nobox")),$(this).data("nobox")||(t=document.createElement("a"),$(t).attr("data-fancybox","gallery"),$(t).attr("href",$(this).attr("src")),$(t).attr("data-caption",$(this).attr("alt")),$(this).wrap(t),void 0!==(t=$(this).attr("alt"))&&null!=t&&""!=t&&$(this).after('<div style="text-align:center;text-decoration:none;color:#949292;">'+$(this).attr("alt")+"</div>"))})})</script><style></style><meta name="generator" content="Hexo 4.2.1"></head><body><div class="wrapper"><header><nav class="navbar"><div class="container"><div class="navbar-header header-logo"><a href="/">亦之日记</a></div><div class="menu navbar-right"><a class="menu-item" href="/archives/">文章</a> <a class="menu-item" href="/tag/">标签</a> <a class="menu-item" href="/categories/%E7%AC%94%E8%AE%B0/">笔记</a> <a class="menu-item" href="/categories/%E6%8A%98%E8%85%BE/">折腾</a> <a class="menu-item" href="/categories/%E7%A2%8E%E8%AF%AD/">碎语</a> <a class="menu-item" href="/categories/%E5%8E%9F%E5%88%9B%E8%BD%AF%E4%BB%B6/">原创软件</a> <a class="menu-item" href="/about/">关于</a> <a class="menu-item" href="/friendlylink/">友链</a> <a class="menu-item" href="https://snowbao.looyeagee.cn/" target="_blank" rel="noopener">雪宝Web版</a> <a class="menu-item" href="https://photo.looyeagee.cn/" target="_blank" rel="noopener">相册</a></div></div></nav><nav class="navbar-mobile" id="nav-mobile"><div class="container"><div class="navbar-header"><div><a href="/">亦之日记</a></div><div class="menu-toggle" onclick="mobileBtn()">&#9776; 菜单</div></div><div class="menu" id="mobile-menu"><a class="menu-item" href="/archives/">文章</a> <a class="menu-item" href="/tag/">标签</a> <a class="menu-item" href="/categories/%E7%AC%94%E8%AE%B0/">笔记</a> <a class="menu-item" href="/categories/%E6%8A%98%E8%85%BE/">折腾</a> <a class="menu-item" href="/categories/%E7%A2%8E%E8%AF%AD/">碎语</a> <a class="menu-item" href="/categories/%E5%8E%9F%E5%88%9B%E8%BD%AF%E4%BB%B6/">原创软件</a> <a class="menu-item" href="/about/">关于</a> <a class="menu-item" href="/friendlylink/">友链</a> <a class="menu-item" href="https://snowbao.looyeagee.cn/" target="_blank" rel="noopener">雪宝Web版</a> <a class="menu-item" href="https://photo.looyeagee.cn/" target="_blank" rel="noopener">相册</a></div></div></nav></header><script>var mobileBtn=function(){var e=document.getElementsByClassName("menu-toggle")[0],t=document.getElementById("mobile-menu");e.classList.contains("active")?(e.classList.remove("active"),t.classList.remove("active")):(e.classList.add("active"),t.classList.add("active"))}</script><div class="main"><div class="container"><div class="post-toc"><div class="tocbot-list"></div><div class="tocbot-list-menu"><a class="tocbot-toc-expand" onclick="expand_toc()">展开目录</a> <a onclick="go_top()">回到顶部</a> <a onclick="go_bottom()">转去底部</a></div></div><script>function expand_toc(){var t=document.querySelector(".tocbot-toc-expand");tocbot.init({tocSelector:".tocbot-list",contentSelector:".post-content",headingSelector:"h1, h2, h3, h4, h5",collapseDepth:6,orderedList:!1,scrollSmooth:!0}),t.setAttribute("onclick","collapse_toc()"),t.innerHTML="收起目录"}function collapse_toc(){var t=document.querySelector(".tocbot-toc-expand");tocbot.init({tocSelector:".tocbot-list",contentSelector:".post-content",headingSelector:"h1, h2, h3, h4, h5",collapseDepth:1,orderedList:!1,scrollSmooth:!0}),t.setAttribute("onclick","expand_toc()"),t.innerHTML="展开目录"}function go_top(){window.scrollTo(0,0)}function go_bottom(){window.scrollTo(0,document.body.scrollHeight)}document.ready(function(){tocbot.init({tocSelector:".tocbot-list",contentSelector:".post-content",headingSelector:"h1, h2, h3, h4, h5",collapseDepth:1,orderedList:!1,scrollSmooth:!0})})</script><article class="post-wrap"><header class="post-header"><h1 class="post-title">Ubuntu Server笔记(二):安装LAMP环境</h1><div class="post-meta">作者: <a itemprop="author" rel="author" href="/">LooyeaGee</a> <span class="post-time">日期: <a href="#">2019-01-12&nbsp;&nbsp;12:32</a> </span><span class="post-category">分类: <a href="/categories/%E7%AC%94%E8%AE%B0/">笔记</a> </span><span class="post-category">访问量:<span id="article_pv">加载中...</span></span></div></header><div class="post-content"><p>所谓<code>LAMP</code>一般就是指Linux+Apache+MySQL+PHP，<code>Linux</code>不用说了，就是我们正在使用的系统，<code>Apache</code>是一款全球使用率最高的Web服务器软件，<code>MySQL</code>是最流行的关系型数据库管理系统之一，<code>PHP</code>是一种服务器端解释型语言，使用率也非常高，入门和配置比较简单。</p><h1 id="一、三个软件的安装"><a href="#一、三个软件的安装" class="headerlink" title="一、三个软件的安装"></a>一、三个软件的安装</h1><h2 id="1-Apache的安装"><a href="#1-Apache的安装" class="headerlink" title="1.Apache的安装"></a>1.Apache的安装</h2><p>使用apt源安装简单方便：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install apache2 -y</span><br></pre></td></tr></table></figure><p>安装后打开浏览器访问你的服务器，应该会看到Apache2 ubuntu default page，不然就是出了问题。</p><h2 id="2-安装PHP"><a href="#2-安装PHP" class="headerlink" title="2.安装PHP"></a>2.安装PHP</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install php7.2 -y</span><br></pre></td></tr></table></figure><h2 id="3-安装MySQL"><a href="#3-安装MySQL" class="headerlink" title="3.安装MySQL"></a>3.安装MySQL</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install mysql-server -y</span><br></pre></td></tr></table></figure><h2 id="4-安装PHP-MySQL相关组件"><a href="#4-安装PHP-MySQL相关组件" class="headerlink" title="4.安装PHP-MySQL相关组件"></a>4.安装PHP-MySQL相关组件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install php7.2-mysql -y</span><br></pre></td></tr></table></figure><p>到这里，环境已经安装完毕，接下来就是配置了。</p><h1 id="二、MySQL的配置"><a href="#二、MySQL的配置" class="headerlink" title="二、MySQL的配置"></a>二、MySQL的配置</h1><h2 id="1-MySQL-root密码修改"><a href="#1-MySQL-root密码修改" class="headerlink" title="1.MySQL root密码修改"></a>1.MySQL root密码修改</h2><p>新版本的MySQL安装的时候没有让用户输入密码，但是给我们分配了一个名为<code>debian-sys-maint</code>的用户，至于密码我们要执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/mysql/debian.cnf</span><br></pre></td></tr></table></figure><p>配置文件中的password字段就是密码，记录下来，退出vim。然后执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u debian-sys-maint -p 密码</span><br></pre></td></tr></table></figure><p>首先我们要进入到mysql数据库：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use mysql;</span><br></pre></td></tr></table></figure><p>然后我们修改root的密码：<br>第一句的<code>PASSWORD(str)</code>是加密函数。第二句是将默认认证方式改为<code>mysql_native_password</code>，第三句是刷新权限。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">update user <span class="built_in">set</span> authentication_string=PASSWORD(<span class="string">"你要改的密码"</span>) <span class="built_in">where</span> user=<span class="string">'root'</span>;</span><br><span class="line">update user <span class="built_in">set</span> plugin=<span class="string">"mysql_native_password"</span>;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure><h2 id="2-MySQL配置外网访问-不安全"><a href="#2-MySQL配置外网访问-不安全" class="headerlink" title="2.MySQL配置外网访问(不安全)"></a>2.MySQL配置外网访问(不安全)</h2><p>配置外网能访问MySQL，方便我们在使用图形化工具导入导出数据(接着上一步)，这句话的意思是采用授权将root用户登录MySQL的主机改为<code>%</code>，即所有主机，然后刷新权限退出。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">grant all on *.* to root@<span class="string">'%'</span> identified by <span class="string">'刚刚设置的密码'</span> with grant option;</span><br><span class="line">flush privileges;</span><br><span class="line">quit;</span><br></pre></td></tr></table></figure><p>退出之后我们还要再修改一下MySQL的配置文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/mysql/mysql.conf.d/mysqld.cnf</span><br></pre></td></tr></table></figure><p>注释掉<code>bind-address = 127.0.0.1</code>，最后重启MySQL：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service mysql restart</span><br></pre></td></tr></table></figure><h1 id="三、网站的配置-以typecho为例"><a href="#三、网站的配置-以typecho为例" class="headerlink" title="三、网站的配置(以typecho为例)"></a>三、网站的配置(以typecho为例)</h1><h2 id="1-下载typecho"><a href="#1-下载typecho" class="headerlink" title="1.下载typecho"></a>1.下载typecho</h2><p>以下的步骤是下载解压typecho，并把网站移动到/var/www/html中去：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span></span><br><span class="line">wget http://typecho.org/downloads/1.1-17.10.30-release.tar.gz</span><br><span class="line">tar -zxvf 1.1-17.10.30-release.tar.gz</span><br><span class="line">sudo mv build/* /var/www/html</span><br></pre></td></tr></table></figure><p>访问你的网站，输入数据库信息等，就可以使用typecho博客啦！如果遇到无法选择数据库适配器，请重启Apache2：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service apache2 restart</span><br></pre></td></tr></table></figure><h2 id="2-配置HTTPS访问"><a href="#2-配置HTTPS访问" class="headerlink" title="2.配置HTTPS访问"></a>2.配置HTTPS访问</h2><p>HTTP早就不安全啦，可能你的网络提供商正无时无刻的查看着你通过HTTP协议访问的信息，使用HTTPS协议就可以避免这个问题，使你网站的浏览者的安全得到保障。</p><h3 id="A-申请SSL证书"><a href="#A-申请SSL证书" class="headerlink" title="A.申请SSL证书"></a>A.申请SSL证书</h3><p>腾讯云用户可以直接在SSL管理界面免费申请一年的证书，其他用户可以在FreeSSL.org申请免费证书，过程我这里不做讲解了。</p><h3 id="B-配置SSL证书"><a href="#B-配置SSL证书" class="headerlink" title="B.配置SSL证书"></a>B.配置SSL证书</h3><p>HTTPS协议的端口缺省是443，我们首先需要加载Apache的SSL模块并启动默认SSL站点：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo a2enmod ssl</span><br><span class="line">sudo a2ensite default-ssl</span><br></pre></td></tr></table></figure><p>将我们的私钥(.key)文件，和证书文件(.pem)放到一个地方，比如说/etc/apache2/ssl，私钥可千万别给别人哦。然后配置默认ssl站点：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/apache2/sites-enabled/default-ssl.conf</span><br></pre></td></tr></table></figure><p>修改<code>SSLCertificateFile</code>为自己的证书文件，修改<code>SSLCertificateKeyFile</code>为自己的私钥文件。然后重启Apache2即可正常访问了。</p><h3 id="C-80重定向到443端口"><a href="#C-80重定向到443端口" class="headerlink" title="C.80重定向到443端口"></a>C.80重定向到443端口</h3><p>有些同学喜欢输入http://域名 这样就是使用了http协议，我们想让它自动跳转到443要怎么办呢？有两种方法，一种是更改Apache默认站点的配置设置重定向，一种是使用<code>.htaccess</code>配置文件来重定向，后者比较简单，所以我来讲解第二种。首先Apache2要加载重写模块并创建配置文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo a2enmod rewrite</span><br><span class="line">sudo service apache2 restart</span><br><span class="line">sudo vim /var/www/html/.htaccess</span><br></pre></td></tr></table></figure><p>然后在<code>.htaccess</code>配置文件中写入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">RewriteEngine on</span><br><span class="line">RewriteCond %&#123;SERVER_PORT&#125; !^443$</span><br><span class="line">RewriteRule ^.*$ https://域名%&#123;REQUEST_URI&#125; [L,R]</span><br></pre></td></tr></table></figure><p>简单来说就是当前用户不是通过443端口访问的话，就跳转到https://域名 。</p></div><section class="post-copyright"><p class="copyright-item"><span>文章作者:</span> <span>LooyeaGee</span></p><p class="copyright-item"><span>文章链接:</span> <span><a href="https://looyeagee.cn/notes/Ubuntu-LAMP/">https://looyeagee.cn/notes/Ubuntu-LAMP/</a></span></p><p class="copyright-item"><span>版权声明:</span> <span>本博客采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a>进行许可</span></p></section><section class="post-tags"><div><span>标签:</span> <span class="tag"></span></div><div><a href="javascript:window.history.back();">返回</a> <span>&nbsp;&nbsp; /&nbsp;&nbsp; </span><a href="/archives/">首页</a></div></section><section class="post-nav"><a class="prev" rel="prev" href="/software/zuoyebao/">[开源]一键登录厂里作业宝（嘘～）</a> <a class="next" rel="next" href="/notes/Ubuntu-start/">Ubuntu Server笔记(一):Ubuntu入门</a></section><br><br><section id="comments" class="comments"><style>.comments{margin:30px;padding:10px;background:#fff}@media screen and (max-width:800px){.comments{margin:auto;padding:10px;background:#fff}}</style><div class="valine_comment"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>new Valine({el:".valine_comment",app_id:"GGS59T6lHdF3dH3fhiSJwu4G-MdYXbMMI",app_key:"mqefY3TJMDaBRqc44I7OdYtY",placeholder:"说点什么呗",notify:"false",verify:"false",avatar:"monsterid",visitor:!0})</script></section></article></div></div><footer id="footer" class="footer">访问总量：<span id="pv">加载中...</span><br><a href="http://beian.miit.gov.cn" target="__blank">湘ICP备19026259号-1</a> • <a target="_blank" style="line-height:18px" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=43018102000289"><img src="https://cdn.looyeagee.cn/blog/img/wangan.png" data-nobox="true" style="width:16px;height:16px;vertical-align:sub">湘公网安备43018102000289号</a><br>Copyright &copy; 2020 <a href="https://looyeagee.cn/">亦之日记</a> 的博客 • Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></footer><script>const path_name=decodeURI(window.location.pathname);$.ajax({type:"POST",url:"https://api.looyeagee.cn/api/visit"+path_name,success:function(t){$("#article_pv").html(t.hits),$("#pv").html(t.all)},error:function(t){}})</script></div></body></html>